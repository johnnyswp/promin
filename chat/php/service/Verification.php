<?php
class Verification extends Service { private $config; public function onRegister() { parent::onRegister(); $this->config = $this->get('config'); } public function verifyInstallation() { $sp8af77c = $this->config->data['services']['verify']; $sp4f3367 = $sp8af77c['code']; $spd46846 = $sp8af77c['token']; return $this->verifyCodeToken($sp4f3367, $spd46846); } public function verifyCodeToken($sp4f3367, $spd46846) { if (is_array($sp4f3367)) { return !empty($sp4f3367[0]) && !empty($sp4f3367[1]) && !empty($spd46846) && sha1(md5($sp4f3367[0] . $sp4f3367[1])) == $spd46846; } return !empty($sp4f3367) && !empty($spd46846) && sha1(md5($sp4f3367)) == $spd46846; } public function updateInstallation($sp4f3367, $spd46846) { $this->config->updateParameters(array('services' => array('verify' => array('code' => $sp4f3367, 'token' => $spd46846)))); } }